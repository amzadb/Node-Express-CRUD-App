<%- include('layout/header') %>
<div class="container">
    <div class="row my-4">
        <div class="col-lg-12">
            <% if (message) { %>
                <div class="alert alert-dismissible fade show alert-<%= message.type %>" role="alert">
                    <button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close">
                    </button> <strong><%= message.message %></strong>
                </div>
            <% } %>
            <!-- Delete Confirmation Modal -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Deletion Confirmation</h4>
                        </div>
                        <div class="modal-body">
                            <p><strong>Are you sure you want to delete the user?</strong></p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <a id="deleteLink" class="btn btn-default btn-danger" href="#">Delete</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-stripped text-center my-3">
                    <thead>
                        <tr class="table-dark">
                            <th>ID</th>
                            <th>Image</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for(var i=0; i<users.length; i++) {%>
                            <tr class="align-middle">
                                <td><%= i+1 %></td>
                                <td><img src="<%= users[i].image %>" width="50" class="img-thumbnail"></td>
                                <td><%= users[i].name %></td>
                                <td><%= users[i].email %></td>
                                <td><%= users[i].phone %></td>
                                <td>
                                    <a href="#" class="text-danger delete-button" data-toggle="modal" data-target="#myModal" data-user-id="<%= users[i]._id %>"><i class="fas fa-trash fa-lg mx-1"></i></a>
                                    <a href="/edit/<%= users[i]._id %>" class="text-success"><i class="fas fa-edit fa-lg mx-1"></i></a>
                                </td>
                            </tr>
                         <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function () {
        $('.delete-button').click(function () {
            var userId = $(this).data('user-id');
            $('#userIdToDelete').text(userId);
            $('#deleteLink').attr('href', '/delete/' + userId);
        });
    });
</script>
<%- include('layout/footer') %>
